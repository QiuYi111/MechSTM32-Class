# LCD 绘制与电机控制综合实验文档

本实验是整个课程的进阶实验，结合了 LCD 显示技术、闭环控制思想（转速反馈）以及复杂的算法实现。

## 1. 实验目标
- 掌握 LCD 屏幕的底层绘制算法（线条、多边形、圆形填充）。
- 学习如何利用过采样 (Oversampling) 技术提高低速编码器信号的读取精度。
- 实现带实时数据反馈的电机控制系统界面。

## 2. 实验内容

### 任务 1: 几何图形绘制算法
在 LCD 上实现高效的图形填充算法。
- **绘制图形**: 三角形、矩形、圆形（包括轮廓和实心填充）。
- **算法细节**: 
  - 扫描线算法 (Scanline algorithm) 用于三角形填充。
  - 中点圆算法 (Midpoint circle algorithm) 用于圆形绘制。
- **现象**: LCD 屏幕左侧显示轮廓图形，右侧显示对应的实心填充图形。

### 任务 2: 电机控制与闭环监控
结合电位器、电机和 LCD，打造一个监控工作站。
- **控制流**:
  1. ADC 采集电位器电压。
  2. 将电压映射为 PWM 占空比 (0-100%)。
  3. 控制直流电机输出。
- **监控流**:
  1. 使用 TIM3 定时器以 20kHz 频率对编码器引脚进行过采样。
  2. 实现低通滤波，计算稳定的 RPM（转数/分）。
  3. 在 LCD 上实时刷新：**运行时间**、**设定占空比**、**实时 RPM** 以及 **电机方向**。

## 3. 核心技术点
- **过采样 (Oversampling)**: 面对低线数编码器或干扰较大的环境，通过极高频率的采样和逻辑判断，滤除干扰毛刺，保证 RPM 数据的准确性。
- **UI 刷新策略**: 区分背景绘制和动态数据刷新，避免 LCD 全屏刷新导致的闪烁感。

## 4. 硬件连线
- **电机反馈**: PF11 (TIM3 捕获/过采样)。
- **电机驱动**: PF9 (FWD), PF10 (REV)。
- **电位器**: PA1 (ADC_CH1)。

## 5. 源码位置
- 实现文件: `User/source/experiment_lcd.c`
- 接口定义: `User/source/experiment_lcd.h`
- 底层驱动: `BSP/lcd.c`, `BSP/motor.c`
