# ADC 综合实验文档

本实验主要介绍 STM32 的模数转换器 (ADC) 的基本使用方法，包括电压监测、显示、以及利用 ADC 采样值控制其他外设（如 LED 和跑马灯）。

## 1. 实验目标
- 掌握 STM32 ADC 控制引脚 (PA1) 的初始化配置。
- 学习如何读取 ADC 通道原始值并将其转换为电压值 (0-3.3V)。
- 练习将 ADC 数据应用于实时控制逻辑（亮度控制、速度控制）。

## 2. 硬件资源
- **处理器**: STM32F103 (或兼容型号)
- **输入**: PA1 引脚（连接至实验板电位器）
- **输出**: 
  - 串口 (UART1) 用于数据打印。
  - LED1-4 (PC0-PC3) 用于状态显示。

## 3. 实验内容

### 实验 1: ADC 电压监测
实时读取 PA1 的电压值，并通过串口打印到 PC 端串口助手。
- **核心逻辑**: 调用 `ADC_ReadVoltage(ADC_CHANNEL_1)` 获取电压，使用 `sprintf` 格式化后发送。
- **现象**: 旋转电位器，串口助手显示的电压值随之连续变化。

### 实验 2: LED 亮度控制 (基于 PWM)
将电位器的输出电压映射到 LED 的 PWM 占空比，从而实现无极调光。
- **映射关系**: `0.0V - 3.3V` 对应 `0% - 100%` 占空比。
- **现象**: 旋转电位器，LED 亮度随之变亮或变暗。

### 实验 3: 跑马灯速度与方向控制
使用 ADC 采样值作为跑马灯的切换延迟时间，并配合按键控制旋转方向。
- **速度分级**:
  - <= 0.5V: 500ms (最慢)
  - 0.5V - 2.5V: 逐级加速
  - \> 2.5V: 50ms (最快)
- **方向控制**:
  - Key S1: 切换为顺时针旋转。
  - Key S2: 切换为逆时针旋转。
- **现象**: 顺时针旋转电位器，跑马灯速度加快；按下按键切换旋转方向。

## 4. 关键 API
- `ADC_Config()`: 初始化 ADC 外设时钟、引脚及采样参数。
- `ADC_ReadVoltage(channel)`: 读取指定通道的电压值 (float)。
- `PWM_SetDutyCycle(duty)`: 设置软件 PWM 的占空比 (0-100)。

## 5. 源码位置
- 代码实现: `exp/adc_main.c`
- 驱动库: `BSP/adc.c`, `BSP/pwm.c`
